<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>라디오 사연 모집!</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* 라디오 버튼 그룹 레이아웃을 위한 기본 스타일 추가 */
        .radio-group label {
            margin-right: 15px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <img src="/yedamLogo.png" alt="예담직업전문학교 로고" class="header-logo">

            <h1>라디오 사연 모집!</h1>
            <p class="subtitle">당신의 특별한 이야기를 들려주세요</p>
        </header>

        <section class="section story-lookup-area">
            <h2>내 사연 조회 및 수정</h2>
            <p class="section-desc">**이름/닉네임**과 **사연 비밀번호**로 사연을 조회하고 수정할 수 있습니다</p>
            
            <form action="/story_modify.html" method="get">
                <div class="form-group">
                    <label for="lookup-name-submit">이름/닉네임</label>
                    <input type="text" id="lookup-name-submit" name="lookup_name" placeholder="사연 작성 시 사용한 이름/닉네임">
                </div>
                <div class="form-group">
                    <label for="lookup-pw-submit">사연 비밀번호</label>
                    <input type="password" id="lookup-pw-submit" name="lookup_pw"  placeholder="사연 작성 시 설정한 비밀번호">
                </div>
                
                <div class="submit-area">
                    <button type="submit" class="submit-button">사연 조회하기</button>
                </div>
            </form>
        </section>

        <form action="/submit-story" method="post" class="story-form" id="story-submit-form">
            <section class="section essential-info">
                <h2>사연자 정보</h2>
                <div class="form-group">
                    <label for="story_name">이름/닉네임</label>
                    <input type="text" id="story_name" name="story_name" required>
                </div>
                
                <div class="form-group">
                    <label for="story_age">나이</label>
                    <input type="text" id="story_age" name="story_age" required placeholder="나이를 입력하세요.">
                </div>
                
                <div class="form-group">
                    <label>성별</label>
                    <div class="radio-group">
                        <input type="radio" id="gender_male" name="story_gender" value="남성" required>
                        <label for="gender_male">남성</label>
                        
                        <input type="radio" id="gender_female" name="story_gender" value="여성">
                        <label for="gender_female">여성</label>
                        
                        <input type="radio" id="gender_other_radio" name="story_gender" value="기타">
                        <label for="gender_other_radio">직접입력</label>
                    </div>
                    <input type="text" id="story_gender_other" name="story_gender_other" style="display:none; margin-top: 10px;" placeholder="직접 입력">
                </div>
            </section>
            
            <section class="section story-content-area">
                <h2>사연 내용</h2>
                
                <div class="form-group">
                    <label for="story_pw">사연 비밀번호
                    사연 조회 및 수정을 위한 비밀번호 설정입니다</label>
                    <input type="password" id="story_pw" name="story_pw" required placeholder="4자리 이상, 대/소문자, 특수문자 포함">
                </div>

                <div class="form-group">
                    <label for="story_pw_confirm">사연 비밀번호 확인</label>
                    <input type="password" id="story_pw_confirm" required placeholder="비밀번호를 다시 입력하세요.">
                </div>
                
                <div class="form-group">
                    <label for="story_content">*사연을 작성해 주세요 *</label>
                    <textarea id="story_content" name="story_content" rows="10" required placeholder="당신의 이야기를 들려주세요."></textarea>
                </div>
            </section>

            <section class="section prize-info-area">
                <h2>경품 응모 정보 (선택 사항)</h2>
                <div class="form-group checkbox-group">
                    <input type="checkbox" id="gift_apply" name="gift_apply" value="Y">
                    <label for="gift_apply">경품 응모에 참여합니다</label>
                </div>
                
                <div id="prize_info_fields" style="display: none;">
                    <div class="form-group">
                        <label for="applicant_name">경품 수령인 이름(주민등록상 이름)</label>
                        <input type="text" id="applicant_name" name="applicant_name" placeholder="본명">
                    </div>
                    <div class="form-group">
                        <label for="applicant_email">이메일</label>
                        <input type="email" id="applicant_email" name="applicant_email" placeholder="사연 확인용 이메일">
                    </div>
                    <div class="form-group">
                        <label for="applicant_phone">연락처</label>
                        <input type="tel" id="applicant_phone" name="applicant_phone" placeholder="010-XXXX-XXXX">
                    </div>
                    
                    <div class="form-group">
                        <label for="applicant_postal">경품 수령할 주소/우편번호</label>
                        <div class="address-group">
                            <input type="text" id="applicant_postal" name="applicant_postal" placeholder="00000" maxlength="5">
                            <button type="button" class="search-button common-action-button">주소 검색</button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="address_detail">상세 주소</label>
                        <input type="text" id="address_detail" name="address_detail" placeholder="아파트 동/호수, 건물 이름 등">
                    </div>
                    
                    <div class="form-group checkbox-group">
                        <input type="checkbox" id="privacy_agree" name="privacy_agree" value="Y">
                    <label for="privacy_agree">경품 발송을 위한 개인정보 수집 및 이용에 동의합니다</label>
                </div>
            </div>
            </section>

            <div class="submit-area">
                <button type="submit" class="submit-button">사연 제출하기</button>
            </div>
        </form>
    </div>
</body>

<script>
    // 성별-기타 선택 시 직접 입력 필드 토글 로직 (유지)
    const genderRadios = document.querySelectorAll('input[name="story_gender"]');
    const genderOtherInput = document.getElementById('story_gender_other');

    function toggleGenderOtherInput() {
        const selectedGender = document.querySelector('input[name="story_gender"]:checked')?.value; 
        
        if (selectedGender === '기타') {
            genderOtherInput.style.display = 'block';
            genderOtherInput.setAttribute('required', 'required');
            genderOtherInput.value = ''; 
        } else {
            genderOtherInput.style.display = 'none';
            genderOtherInput.removeAttribute('required');
        }
    }

    genderRadios.forEach(radio => {
        radio.addEventListener('change', toggleGenderOtherInput);
    });
    
    // 경품 응모 로직 (유지)
    const giftApplyCheckbox = document.getElementById('gift_apply');
    const prizeInfoSection = document.getElementById('prize_info_fields');

    function togglePrizeInfoSection() {
        const isChecked = giftApplyCheckbox.checked;
        prizeInfoSection.style.display = isChecked ? 'block' : 'none';
        
        const requiredFields = prizeInfoSection.querySelectorAll(
            '#applicant_name, #applicant_email, #applicant_phone, #applicant_postal, #address_detail, #privacy_agree'
        );
        
        requiredFields.forEach(field => {
            if (isChecked) {
                field.setAttribute('required', 'required');
            } else {
                field.removeAttribute('required');
            }
        });
    }

    togglePrizeInfoSection(); 
    giftApplyCheckbox.addEventListener('change', togglePrizeInfoSection);


    // 💡 복구된 비밀번호 일치 확인 및 유효성 검사 로직
    const submitForm = document.getElementById('story-submit-form');
    const storyPwField = document.getElementById('story_pw');
    const storyPwConfirmField = document.getElementById('story_pw_confirm');

    submitForm.addEventListener('submit', function (event) {
        // 1. 비밀번호 일치 확인
        if (storyPwField.value !== storyPwConfirmField.value) {
            event.preventDefault(); // 폼 제출 방지
            alert('🚨 사연 비밀번호가 일치하지 않습니다. 다시 확인해 주세요.');
            storyPwConfirmField.focus();
            return;
        }

        // 2. 비밀번호 복잡성 확인 (서버 측 로직과 동일하게 유지)
        const pw = storyPwField.value;
        const hasUpperCase = /[A-Z]+/g;
        const hasLowerCase = /[a-z]+/g;
        const hasSpecialChar = /[!@#$%^&*]+/g;

        if (pw.length < 4 || !hasUpperCase.test(pw) || !hasLowerCase.test(pw) || !hasSpecialChar.test(pw)) {
            event.preventDefault();
            alert('🚨 비밀번호는 4자리 이상이며, 대문자, 소문자, 특수문자(!@#$%^&*)를 포함해야 합니다.');
            storyPwField.focus();
            return;
        }
    });

</script>

</html>