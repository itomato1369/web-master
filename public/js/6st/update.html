<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>수정</title>
    <link href="style.css" rel="stylesheet">
</head>

<body>
    <h2>수정화면</h2>
    <div id="add-student">
        <form action="">
            <label for="sno">학생번호</label>
            <input type="text" disabled id="sno">
            <label for="sname">이름</label>
            <input type="text" id="sname">
            <label for="score">점수</label>
            <input type="number" id="score">
            <input type="submit" value="저장">
        </form>
    </div>
    <script>
        // 저장이벤트
        document.querySelector('form').addEventListener('submit', function (e) {
            // 폼이란 태그를 찾아오겠다 거기에데 submit 이벤트를 걸겠습니다
            e.preventDefault();
            let data = JSON.parse(localStorage.getItem('students'))
            let changedName = document.getElementById("sname").value;
            let changedScore = document.getElementById("score").value;
            // data 값을 변경
            data.forEach((item) => {
                if (item.sno == sno) {
                    item.sname = changedName;
                    item.score = changedScore;
                }
            });
            localStorage.setItem('students', JSON.stringify(data)); // 저장
            localStorage.removeItem('search');
            location.href = 'index.html';
        });
        // let data = [];
        // 조회
        let sno = localStorage.getItem('search'); // 검색정보
        if (!sno) {
            alert('정상적인 경로가 아닙니다');
        } else {
            let data = JSON.parse(localStorage.getItem('students')); // 전체목록
            let result = data.filter((item) => item.sno == sno)[0]; // 학생정보 검색
            // console.log(result);
            // 검색결과를 화면에 출력
            console.log(sno);
            document.getElementById("sno").value = result.sno;
            document.getElementById("sname").value = result.sname;
            document.getElementById("score").value = result.score;
            // location.href = 'index.html';
        }
        
    </script>

</body>

</html>